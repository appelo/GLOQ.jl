<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 3 · GLOQ.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GLOQ.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Governing models and notation</span><ul><li><a class="tocitem" href="../model/">Models</a></li><li><a class="tocitem" href="../experiment/">Protocols</a></li></ul></li><li><span class="tocitem">Workflow and examples</span><ul><li><a class="tocitem" href="../workflow/">Workflow</a></li><li><a class="tocitem" href="../example1/">Example 1</a></li><li><a class="tocitem" href="../example2/">Example 2</a></li><li class="is-active"><a class="tocitem" href>Example 3</a><ul class="internal"><li><a class="tocitem" href="#Example-3:-uncertainty-quantification-for-a-single-qubit-based-on-noisy-data-of-a-Ramsey-experiment."><span>Example 3: uncertainty quantification for a single qubit based on noisy data of a Ramsey experiment.</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../methods/">Methods</a></li><li><a class="tocitem" href="../function-index/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Workflow and examples</a></li><li class="is-active"><a href>Example 3</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example 3</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/appelo/GLOQ.jl/blob/master/docs/src/example3.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Example-3:-uncertainty-quantification-for-a-single-qubit-based-on-noisy-data-of-a-Ramsey-experiment."><a class="docs-heading-anchor" href="#Example-3:-uncertainty-quantification-for-a-single-qubit-based-on-noisy-data-of-a-Ramsey-experiment.">Example 3: uncertainty quantification for a single qubit based on noisy data of a Ramsey experiment.</a><a id="Example-3:-uncertainty-quantification-for-a-single-qubit-based-on-noisy-data-of-a-Ramsey-experiment.-1"></a><a class="docs-heading-anchor-permalink" href="#Example-3:-uncertainty-quantification-for-a-single-qubit-based-on-noisy-data-of-a-Ramsey-experiment." title="Permalink"></a></h2><p>In this example, we apply the Metropolis-Hastings algorithm to do uncertainty quantification for a single qubit based on noisy synthetic data of a Ramsey experiment. We provide an interface to the Julia Bayesian inference  package <a href="https://turing.ml/stable/">Turing.jl</a>. This example can be executed by <code>cd(&quot;examples&quot;);include(&quot;SingleQubitBayesian.jl&quot;)</code>.</p><h4 id="Load-the-needed-packages"><a class="docs-heading-anchor" href="#Load-the-needed-packages">Load the needed packages</a><a id="Load-the-needed-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Load-the-needed-packages" title="Permalink"></a></h4><pre><code class="language-julia hljs">using LinearAlgebra
using Turing, Distributions, DifferentialEquations
# Import MCMCChain, Plots, and StatsPlots for visualizations and diagnostics.
using MCMCChains, Plots, StatsPlots
using CSV,DataFrames
# Set a seed for reproducibility.
using Random
Random.seed!(14);
using Plots
include(&quot;../src/GLOQ.jl&quot;)
pyplot()</code></pre><h3 id="Step-1:-generate-the-synthetic-data"><a class="docs-heading-anchor" href="#Step-1:-generate-the-synthetic-data">Step 1: generate the synthetic data</a><a id="Step-1:-generate-the-synthetic-data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-generate-the-synthetic-data" title="Permalink"></a></h3><h4 id="Define-the-system-parameters-and-the-initial-state-vector."><a class="docs-heading-anchor" href="#Define-the-system-parameters-and-the-initial-state-vector.">Define the system parameters and the initial state vector.</a><a id="Define-the-system-parameters-and-the-initial-state-vector.-1"></a><a class="docs-heading-anchor-permalink" href="#Define-the-system-parameters-and-the-initial-state-vector." title="Permalink"></a></h4><pre><code class="language-julia hljs">N_states = 2; # number of states
freqs = [4.1] # transition frequency in GHz
omegas = 2.0*pi.*freqs # change to angular frequency
gamma1   = [25e-05] # decay
gamma2   = [25e-05] # dephasing
omr = 2.0*pi*(4.1 - 1.0e-3) # drive frequency
TC = 2.5*17.0 # total control time

# Initial state
initial_state = 0
rho_u0 = [0.0;0.0]
rho_v0 = [0.0;0.0]
rho_u0[initial_state+1] = 1.0

</code></pre><h4 id="Use-forward-solve-to-generate-the-synthetic-data-of-the-Ramsey-experiment."><a class="docs-heading-anchor" href="#Use-forward-solve-to-generate-the-synthetic-data-of-the-Ramsey-experiment.">Use forward solve to generate the synthetic data of the Ramsey experiment.</a><a id="Use-forward-solve-to-generate-the-synthetic-data-of-the-Ramsey-experiment.-1"></a><a class="docs-heading-anchor-permalink" href="#Use-forward-solve-to-generate-the-synthetic-data-of-the-Ramsey-experiment." title="Permalink"></a></h4><p>Set up the experiment.</p><pre><code class="language-julia hljs"># Duration of the Ramsey experiment, largest dark time
T_Ramsey = 5.0*GLOQ.GLOQ_MICRO_SEC # convert micro-sec to nano-sec
# total number of dark time samples
N_dark_times = 101
t_dark_times = collect(range(0.0, T_Ramsey, length=N_dark_times))</code></pre><p>Use <code>GLOQ.RamseyForwardSolve</code> to generate the data, and then obtain the corresponding population.</p><pre><code class="language-julia hljs">rho_synthetic_ramsey_u,rho_synthetic_ramsey_v = GLOQ.RamseyForwardSolve(
				 rho_u0,rho_v0, # initial values, u for the real part, v for the imaginary part
			     omegas,omr, # transition frequencies, drive frequency
				 gamma1,gamma2, # decay and dephasing parameters 
				 initial_state, # initial state
				 TC,t_dark_times,N_states) # control time, dark time, total number of states
population_synthetic = GLOQ.get_population(rho_synthetic_ramsey_u)</code></pre><h4 id="Add-multiplicative-and-additive-noise-to-the-generated-synthetic-data."><a class="docs-heading-anchor" href="#Add-multiplicative-and-additive-noise-to-the-generated-synthetic-data.">Add multiplicative and additive noise to the generated synthetic data.</a><a id="Add-multiplicative-and-additive-noise-to-the-generated-synthetic-data.-1"></a><a class="docs-heading-anchor-permalink" href="#Add-multiplicative-and-additive-noise-to-the-generated-synthetic-data." title="Permalink"></a></h4><pre><code class="language-julia hljs">noisy_data = copy(population_synthetic)
multiplicative_noise = 1.0.+0.05*randn(N_dark_times) 
noisy_data .*= multiplicative_noise
additive_noise = 0.05*randn(N_dark_times) 
noisy_data .+= additive_noise</code></pre><h4 id="Normalize-the-noisy-data-so-that-it-is-a-population-between-[0,1]."><a class="docs-heading-anchor" href="#Normalize-the-noisy-data-so-that-it-is-a-population-between-[0,1].">Normalize the noisy data so that it is a population between [0,1].</a><a id="Normalize-the-noisy-data-so-that-it-is-a-population-between-[0,1].-1"></a><a class="docs-heading-anchor-permalink" href="#Normalize-the-noisy-data-so-that-it-is-a-population-between-[0,1]." title="Permalink"></a></h4><pre><code class="language-julia hljs">for j = 1:N_states
	shift = minimum(noisy_data[:,j])
	if(shift&lt;0.0)
		noisy_data[:,j] .-= shift
	end
end

for i = 1:N_dark_times
	noisy_data[i,:] ./= sum(noisy_data[i,:])
end</code></pre><h4 id="Plot-the-noisy-data."><a class="docs-heading-anchor" href="#Plot-the-noisy-data.">Plot the noisy data.</a><a id="Plot-the-noisy-data.-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-the-noisy-data." title="Permalink"></a></h4><pre><code class="language-julia hljs">fig = plot(t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_synthetic,
		   label=[&quot;Syn-0&quot; &quot;Syn-1&quot;])
scatter!(fig,t_dark_times./GLOQ.GLOQ_MICRO_SEC,noisy_data,
		 label=[&quot;Noisy-0&quot; &quot;Noisy-1&quot;])

p_true = [freqs;gamma1;gamma2]</code></pre><p><img src="../picture/Example3_noisy_data.png" alt="Example 3: synthetic noisy data"/></p><h4 id="Synthetic-data-with-and-without-noise.-Population-of-different-states-are-presented."><a class="docs-heading-anchor" href="#Synthetic-data-with-and-without-noise.-Population-of-different-states-are-presented.">Synthetic data with and without noise. Population of different states are presented.</a><a id="Synthetic-data-with-and-without-noise.-Population-of-different-states-are-presented.-1"></a><a class="docs-heading-anchor-permalink" href="#Synthetic-data-with-and-without-noise.-Population-of-different-states-are-presented." title="Permalink"></a></h4><ul><li>Syn-0: synthetic data without noise for the energy level 0;</li><li>Syn-1: synthetic data without noise for the energy level 1;</li><li>Noisy-0: noisy data for the energy level 0;</li><li>Noisy-1: noisy data for the energy level 1.</li></ul><h3 id="Step-2:-use-@model-macro-to-provide-interface-to-the-Turing.jl-and-apply-the-MCMC-algorithm."><a class="docs-heading-anchor" href="#Step-2:-use-@model-macro-to-provide-interface-to-the-Turing.jl-and-apply-the-MCMC-algorithm.">Step 2: use <code>@model</code> macro to provide interface to the Turing.jl and apply the MCMC algorithm.</a><a id="Step-2:-use-@model-macro-to-provide-interface-to-the-Turing.jl-and-apply-the-MCMC-algorithm.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-use-@model-macro-to-provide-interface-to-the-Turing.jl-and-apply-the-MCMC-algorithm." title="Permalink"></a></h3><h4 id="Step-2a:-use-@model-macro-to-provide-interface-to-the-Turing.jl.-Check-[the-tutorial-of-Turing.jl](https://turing.ml/dev/docs/using-turing/)-for-more-details."><a class="docs-heading-anchor" href="#Step-2a:-use-@model-macro-to-provide-interface-to-the-Turing.jl.-Check-[the-tutorial-of-Turing.jl](https://turing.ml/dev/docs/using-turing/)-for-more-details.">Step 2a: use <code>@model</code> macro to provide interface to the Turing.jl. Check <a href="https://turing.ml/dev/docs/using-turing/">the tutorial of Turing.jl</a> for more details.</a><a id="Step-2a:-use-@model-macro-to-provide-interface-to-the-Turing.jl.-Check-[the-tutorial-of-Turing.jl](https://turing.ml/dev/docs/using-turing/)-for-more-details.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2a:-use-@model-macro-to-provide-interface-to-the-Turing.jl.-Check-[the-tutorial-of-Turing.jl](https://turing.ml/dev/docs/using-turing/)-for-more-details." title="Permalink"></a></h4><p>Below, <span>$\sigma$</span> is a hyper parameter, <code>_freq</code> and <code>_gamma2</code> are the transition frequency and the dephasing parameter <span>$\gamma_2$</span>. These parameters are sampled based on priori distributions. More specifically, <code>_freq ~ truncated(Normal(4.1,1e-4),4.1-5e-4,4.1+5e-4)</code> means that the random variable <code>_freq</code> is sampled based on a truncated normal distribution whose mean is <span>$4.1$</span> and standard deviation is <span>$1e-4$</span>, and its range is <span>$[4.1-5e-4,4.1+5e-4]$</span>. <span>$\sigma$</span> is sampled based on the inverse gamma distribution and <code>_gamma2</code> is sampled based on a truncated normal distribution. </p><p>Based on the sampled parameters, we apply <code>GLOQ.RamseyForwardSolve</code> to perform a forward solve, and the noisy data is assumed to obey  a priori distribution, which is a multivariate-normal distribution whose mean is the forward simulation results and its covariance matrix is <span>$\sigma I$</span>.</p><pre><code class="language-julia hljs">global sample_number
@model function RamseyExperiment(data)
	 # Priori distribution
	σ ~ InverseGamma() # random hyper parameter $\sigma$ obeys an Inverse Gamma distribution.
    _freq ~ truncated(Normal(4.1,1e-4),4.1-5e-4,4.1+5e-4)
    _gamma2 ~ truncated(Normal(25e-05,2.5e-5),20e-5,30e-5)
	# Perform a Forward solve with sampled parameters
	_rho_ramsey_u,_rho_ramsey_v = GLOQ.RamseyForwardSolve(
					 rho_u0,rho_v0, # initial values, u for the real part, v for the imaginary part
				     2.0*pi*[_freq],omr, # transition frequencies, drive frequency
					 gamma1,[_gamma2], # decay and dephasing parameters ?
					 initial_state, # initial state
					 TC,t_dark_times,N_states;
					 method=&quot;exponential&quot;)
					 #method = Trapezoid()) # control time, dark time, total number of states
	_population_ramsey = GLOQ.get_population(_rho_ramsey_u)
	for i = 1:N_dark_times
        data[i,:] ~ MvNormal(_population_ramsey[i,:], σ)
    end
	global sample_number
	sample_number += 1
	println(&quot;Sample &quot;,sample_number,&quot; done&quot;)
end

model = RamseyExperiment(noisy_data)</code></pre><h4 id="Step-2b:-use-Turing.jl&#39;s-sample-function-to-apply-the-Metropolis-Hastings-algorithm."><a class="docs-heading-anchor" href="#Step-2b:-use-Turing.jl&#39;s-sample-function-to-apply-the-Metropolis-Hastings-algorithm.">Step 2b: use Turing.jl&#39;s <code>sample</code> function to apply the Metropolis-Hastings algorithm.</a><a id="Step-2b:-use-Turing.jl&#39;s-sample-function-to-apply-the-Metropolis-Hastings-algorithm.-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2b:-use-Turing.jl&#39;s-sample-function-to-apply-the-Metropolis-Hastings-algorithm." title="Permalink"></a></h4><p>In the <code>sample</code> function, the first argument is the target <code>model</code> object, the second argument specifies which sampler is applied, and the  third argument is the length of the chain. Here, we use the standard Metropolis-Hastings sampler with a  diagonal covariance matrix.</p><pre><code class="language-julia hljs">sample_number = 0
chain_size = 35000
@time chain = sample(model, MH(Diagonal([5e-3,5e-3,5e-2])), chain_size)</code></pre><p>Burn-in length is set up as <span>$5000$</span> to improve the quality of the chain. We present the chain after burn-in.</p><pre><code class="language-julia hljs">BurnIn = 5000
fig_chain = plot(chain[BurnIn+1:end]);
xticks!(fig_chain[4],[4.099998;4.10;4.1000015],);
display(fig_chain)
display(chain[BurnIn+1:end])</code></pre><p><img src="../picture/Example3_chain.png" alt="Example 3: chain"/></p><h4 id="Sampled-Markov-chain-after-burn-in-and-the-corresponding-posteriori-distribution."><a class="docs-heading-anchor" href="#Sampled-Markov-chain-after-burn-in-and-the-corresponding-posteriori-distribution.">Sampled Markov chain after burn-in and the corresponding posteriori distribution.</a><a id="Sampled-Markov-chain-after-burn-in-and-the-corresponding-posteriori-distribution.-1"></a><a class="docs-heading-anchor-permalink" href="#Sampled-Markov-chain-after-burn-in-and-the-corresponding-posteriori-distribution." title="Permalink"></a></h4><h3 id="Step-3:-Present-the-data"><a class="docs-heading-anchor" href="#Step-3:-Present-the-data">Step 3: Present the data</a><a id="Step-3:-Present-the-data-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-Present-the-data" title="Permalink"></a></h3><h4 id="Step-3a:-convert-the-data-to-[DataFrame](https://dataframes.juliadata.org/stable/)-format-and-calculate-the-mean-value-of-the-Markov-chain"><a class="docs-heading-anchor" href="#Step-3a:-convert-the-data-to-[DataFrame](https://dataframes.juliadata.org/stable/)-format-and-calculate-the-mean-value-of-the-Markov-chain">Step 3a: convert the data to <a href="https://dataframes.juliadata.org/stable/">DataFrame</a> format and calculate the mean value of the Markov chain</a><a id="Step-3a:-convert-the-data-to-[DataFrame](https://dataframes.juliadata.org/stable/)-format-and-calculate-the-mean-value-of-the-Markov-chain-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3a:-convert-the-data-to-[DataFrame](https://dataframes.juliadata.org/stable/)-format-and-calculate-the-mean-value-of-the-Markov-chain" title="Permalink"></a></h4><pre><code class="language-julia hljs">chain_data = DataFrame(chain[BurnIn+1:end])
freq_mean = mean(chain_data._freq)
gamma2_mean = mean(chain_data._gamma2)</code></pre><h4 id="Generate-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain"><a class="docs-heading-anchor" href="#Generate-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain">Generate the Ramsey curve corresponding to the mean value of the chain</a><a id="Generate-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain" title="Permalink"></a></h4><pre><code class="language-julia hljs">rho_chain_mean_u,rho_chain_mean_v = GLOQ.RamseyForwardSolve(
				 rho_u0,rho_v0, # initial values, u for the real part, v for the imaginary part
				 2.0*pi*[freq_mean],omr, # transition frequencies, drive frequency
				 gamma1,[gamma2_mean], # decay and dephasing parameters ?
				 initial_state, # initial state
				 TC,t_dark_times,N_states;
				 method=&quot;exponential&quot;)
population_chain_mean = GLOQ.get_population(rho_chain_mean_u)</code></pre><p>Compare the results with noisy data.</p><pre><code class="language-julia hljs">fig_mean_vs_noisy = plot(t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_chain_mean,
		   		  label=[&quot;Mean-0&quot; &quot;Mean-1&quot;])
scatter!(fig_mean_vs_noisy,t_dark_times./GLOQ.GLOQ_MICRO_SEC,noisy_data,
		 label=[&quot;Noisy data-0&quot; &quot;Noisy data-1&quot;])
display(fig_mean_vs_noisy)</code></pre><p><img src="../picture/Example3_mean_vs_data.png" alt="Example 3: mean value vs noisy data"/></p><h4 id="The-Ramsey-curve-corresponding-to-the-mean-value-vs-data-with-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-data-for-the-energy-level-0-and-1."><a class="docs-heading-anchor" href="#The-Ramsey-curve-corresponding-to-the-mean-value-vs-data-with-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-data-for-the-energy-level-0-and-1.">The Ramsey curve corresponding to the mean value vs data with noise. Mean-0 and Mean-1: the Ramsey curve corresponding to the mean value of the chain for the energy level 0 and 1. Noisy-0 and Noisy-1: noisy data for the energy level 0 and 1.</a><a id="The-Ramsey-curve-corresponding-to-the-mean-value-vs-data-with-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-data-for-the-energy-level-0-and-1.-1"></a><a class="docs-heading-anchor-permalink" href="#The-Ramsey-curve-corresponding-to-the-mean-value-vs-data-with-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-data-for-the-energy-level-0-and-1." title="Permalink"></a></h4><p>Compare the results with noise-free data.</p><pre><code class="language-julia hljs">fig_mean_vs_syn = plot(t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_chain_mean,
				   label=[&quot;Mean-0&quot; &quot;Mean-1&quot;])
scatter!(fig_mean_vs_syn,t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_synthetic,
		 label=[&quot;Syn-0&quot; &quot;Syn-1&quot;])
display(fig_mean_vs_syn)</code></pre><p><img src="../picture/Example3_mean_vs_syn.png" alt="Example 3: mean value vs data without noise"/></p><h4 id="The-Ramsey-curve-corresponding-to-the-mean-value-vs-synthetic-data-without-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Syn-0-and-Syn-1:-synthetic-data-without-noise-for-the-energy-level-0-and-1."><a class="docs-heading-anchor" href="#The-Ramsey-curve-corresponding-to-the-mean-value-vs-synthetic-data-without-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Syn-0-and-Syn-1:-synthetic-data-without-noise-for-the-energy-level-0-and-1.">The Ramsey curve corresponding to the mean value vs synthetic data without noise. Mean-0 and Mean-1: the Ramsey curve corresponding to the mean value of the chain for the energy level 0 and 1. Syn-0 and Syn-1: synthetic data without noise for the energy level 0 and 1.</a><a id="The-Ramsey-curve-corresponding-to-the-mean-value-vs-synthetic-data-without-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Syn-0-and-Syn-1:-synthetic-data-without-noise-for-the-energy-level-0-and-1.-1"></a><a class="docs-heading-anchor-permalink" href="#The-Ramsey-curve-corresponding-to-the-mean-value-vs-synthetic-data-without-noise.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Syn-0-and-Syn-1:-synthetic-data-without-noise-for-the-energy-level-0-and-1." title="Permalink"></a></h4><h4 id="Display-the-difference-between-the-mean-value-of-the-chain-and-the-true-value"><a class="docs-heading-anchor" href="#Display-the-difference-between-the-mean-value-of-the-chain-and-the-true-value">Display the difference between the mean value of the chain and the true value</a><a id="Display-the-difference-between-the-mean-value-of-the-chain-and-the-true-value-1"></a><a class="docs-heading-anchor-permalink" href="#Display-the-difference-between-the-mean-value-of-the-chain-and-the-true-value" title="Permalink"></a></h4><pre><code class="language-julia hljs">println( &quot;Error of freqs: &quot;,abs(freq_mean-freqs[1]),
		 &quot; Error of γ₂: &quot;,abs(gamma2_mean-gamma2[1]) )</code></pre><h4 id="Results:"><a class="docs-heading-anchor" href="#Results:">Results:</a><a id="Results:-1"></a><a class="docs-heading-anchor-permalink" href="#Results:" title="Permalink"></a></h4><pre><code class="nohighlight hljs">Error of freqs: 3.7845511347001093e-7 Error of γ₂: 8.2938489833124e-7</code></pre><h4 id="Sample-from-the-Markov-chain-and-perform-forward-solves,-then-we-compare-the-sampled-results-with-the-noisy-data-and-the-forward-solve-with-parameters-corresponding-to-the-mean-value-of-the-chain."><a class="docs-heading-anchor" href="#Sample-from-the-Markov-chain-and-perform-forward-solves,-then-we-compare-the-sampled-results-with-the-noisy-data-and-the-forward-solve-with-parameters-corresponding-to-the-mean-value-of-the-chain.">Sample from the Markov chain and perform forward solves, then we compare the sampled results with the noisy data and the forward solve with parameters corresponding to the mean value of the chain.</a><a id="Sample-from-the-Markov-chain-and-perform-forward-solves,-then-we-compare-the-sampled-results-with-the-noisy-data-and-the-forward-solve-with-parameters-corresponding-to-the-mean-value-of-the-chain.-1"></a><a class="docs-heading-anchor-permalink" href="#Sample-from-the-Markov-chain-and-perform-forward-solves,-then-we-compare-the-sampled-results-with-the-noisy-data-and-the-forward-solve-with-parameters-corresponding-to-the-mean-value-of-the-chain." title="Permalink"></a></h4><pre><code class="language-julia hljs">global fig_result
for i = 1:1000
	global fig_result
	sample_ind = rand(1:chain_size-BurnIn)
    freq_sample = chain_data._freq[sample_ind]
    gamma2_sample = chain_data._gamma2[sample_ind]
    rho_sample_u,rho_sample_v = GLOQ.RamseyForwardSolve(
				 rho_u0,rho_v0, # initial values, u for the real part, v for the imaginary part
				 2.0*pi*[freq_sample],omr, # transition frequencies, drive frequency
				 gamma1,[gamma2_sample], # decay and dephasing parameters 
				 initial_state, # initial state
				 TC,t_dark_times,N_states;
				 method=&quot;exponential&quot;)
    population_sample = GLOQ.get_population(rho_sample_u)
	if (i==1)
    	fig_result=plot(t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_sample,
              color = &quot;#BBBBBB&quot;, label=&quot;&quot;);
	else
    	plot!(fig_result,t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_sample,
              color = &quot;#BBBBBB&quot;, label=&quot;&quot;);
	end
end
plot!(fig_result,t_dark_times./GLOQ.GLOQ_MICRO_SEC,population_chain_mean,
	  linewidth=1.0,label=[&quot;Mean-0&quot; &quot;Mean-1&quot;])
scatter!(fig_result,t_dark_times./GLOQ.GLOQ_MICRO_SEC,noisy_data,
	     label=[&quot;Noisy data-0&quot; &quot;Noisy data-1&quot;])
display(fig_result)</code></pre><p><img src="../picture/Example3_post.png" alt="Example 3: the Ramsey results corresponding to the posterior distribution and the mean results"/></p><h4 id="Compare-the-Ramsey-curves-generated-by-the-samples-from-the-chain.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-synthetic-data-for-the-energy-level-0-and-1."><a class="docs-heading-anchor" href="#Compare-the-Ramsey-curves-generated-by-the-samples-from-the-chain.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-synthetic-data-for-the-energy-level-0-and-1.">Compare the Ramsey curves generated by the samples from the chain. Mean-0 and Mean-1: the Ramsey curve corresponding to the mean value of the chain for the energy level 0 and 1. Noisy-0 and Noisy-1: noisy synthetic data for the energy level 0 and 1.</a><a id="Compare-the-Ramsey-curves-generated-by-the-samples-from-the-chain.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-synthetic-data-for-the-energy-level-0-and-1.-1"></a><a class="docs-heading-anchor-permalink" href="#Compare-the-Ramsey-curves-generated-by-the-samples-from-the-chain.-Mean-0-and-Mean-1:-the-Ramsey-curve-corresponding-to-the-mean-value-of-the-chain-for-the-energy-level-0-and-1.-Noisy-0-and-Noisy-1:-noisy-synthetic-data-for-the-energy-level-0-and-1." title="Permalink"></a></h4></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../example2/">« Example 2</a><a class="docs-footer-nextpage" href="../types/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Saturday 19 February 2022 02:45">Saturday 19 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
